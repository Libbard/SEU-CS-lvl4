<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Practice Exam - Theory of Computing</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
      window.MathJax = {
        tex: { inlineMath: [['$', '$'], ['\\(', '\\)']] },
        svg: { fontCache: 'global' }
      };
    </script>
    <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>

    <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;600;700;900&display=swap" rel="stylesheet">
    <style>
        body { font-family: 'Cairo', sans-serif; background-color: #faf5ff; } /* Ø¨Ù†ÙØ³Ø¬ÙŠ ÙØ§ØªØ­ Ø¬Ø¯Ø§Ù‹ */
        .purple-gradient { background: linear-gradient(135deg, #581c87 0%, #9333ea 100%); }
        
        .question-card {
            background: white;
            border-radius: 12px;
            padding: 20px;
            margin-bottom: 20px;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
            border: 1px solid #e9d5ff;
            transition: all 0.3s;
        }
        
        .question-card.correct-card { border-right: 5px solid #22c55e; background-color: #f0fdf4; }
        .question-card.wrong-card { border-right: 5px solid #ef4444; background-color: #fef2f2; }

        .option-btn {
            display: block;
            width: 100%;
            text-align: right;
            padding: 12px 15px;
            margin: 8px 0;
            background-color: #faf5ff;
            border: 2px solid #f3e8ff;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.2s;
            font-size: 0.95rem;
        }
        .option-btn:hover:not(.disabled) { background-color: #e9d5ff; border-color: #9333ea; }
        
        .option-btn.correct { background-color: #dcfce7 !important; border-color: #22c55e !important; color: #166534; font-weight: bold; }
        .option-btn.wrong { background-color: #fee2e2 !important; border-color: #ef4444 !important; color: #991b1b; }
        .option-btn.disabled { pointer-events: none; opacity: 0.8; }

        .cheat-box {
            display: none;
            margin-top: 15px;
            padding: 15px;
            background-color: #fffbeb;
            border: 1px solid #fcd34d;
            border-radius: 8px;
            color: #92400e;
            font-size: 0.9rem;
            animation: fadeIn 0.5s;
        }

        .essay-answer {
            display: none;
            margin-top: 15px;
            padding: 20px;
            background-color: #f3e8ff;
            border-right: 4px solid #9333ea;
            border-radius: 8px;
            color: #4c1d95;
            line-height: 1.8;
        }

        @media print {
            .no-print { display: none !important; }
            body { background: white; }
            .question-card { break-inside: avoid; border: 1px solid #ccc; box-shadow: none; }
            .cheat-box, .essay-answer { display: block !important; border: 1px dashed #999; }
        }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(-5px); } to { opacity: 1; transform: translateY(0); } }
    </style>
</head>
<body class="bg-slate-50 text-slate-800 pb-20">

    <nav class="bg-white shadow-md sticky top-0 z-50 border-b border-purple-100 no-print">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex justify-between h-16 items-center">
                <div class="flex items-center">
                    <a href="index.html" class="text-2xl font-black text-purple-700 ml-2">TheoryMaster</a>
                    <span class="text-xs bg-purple-100 text-purple-800 py-1 px-2 rounded-full font-bold border border-purple-200">Exam Mode</span>
                </div>
                
                <div class="flex items-center gap-2 md:gap-3">
                    <a href="index.html" class="flex items-center gap-1 bg-gray-100 hover:bg-gray-200 text-gray-700 px-3 py-1.5 rounded-lg text-sm font-bold transition">
                        <span>ğŸ </span> <span class="hidden md:inline">Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©</span>
                    </a>
                    <div id="timer" class="bg-slate-800 text-white px-3 py-1.5 rounded-lg font-mono font-bold text-sm md:text-base">90:00</div>
                    <button onclick="window.print()" class="bg-slate-200 hover:bg-slate-300 text-slate-700 px-3 py-1.5 rounded-lg text-sm font-bold" title="Ø·Ø¨Ø§Ø¹Ø©">ğŸ–¨ï¸</button>
                    <button onclick="resetExam()" class="bg-red-100 hover:bg-red-200 text-red-700 px-3 py-1.5 rounded-lg text-sm font-bold" title="Ø¥Ø¹Ø§Ø¯Ø©">ğŸ”„</button>
                </div>
            </div>
        </div>
    </nav>

    <header class="purple-gradient text-white py-12 text-center shadow-lg mb-8 no-print">
        <h1 class="text-3xl md:text-4xl font-black mb-2">CS-242 Final Practice Exam</h1>
        <p class="text-purple-100 text-lg">40 Ø³Ø¤Ø§Ù„ Ø´Ø§Ù…Ù„ + 5 Ø£Ø³Ø¦Ù„Ø© Ù…Ù‚Ø§Ù„ÙŠØ© (ØªØºØ·ÙŠØ© ÙƒØ§Ù…Ù„Ø© Ù„Ù„Ù…Ù†Ù‡Ø¬)</p>
    </header>

    <main class="max-w-4xl mx-auto px-4">
        
        <div class="flex justify-end mb-6 no-print">
            <button onclick="revealAll()" class="bg-purple-600 hover:bg-purple-700 text-white px-6 py-2 rounded-full font-bold shadow-lg transition transform hover:scale-105 flex items-center gap-2">
                <span>ğŸ‘ï¸</span> ÙƒØ´Ù Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø¥Ø¬Ø§Ø¨Ø§Øª
            </button>
        </div>

        <div id="quiz-container" class="space-y-6"></div>

    </main>

    <script>
        // ==========================================
        // 1. BANK DATA (Theory)
        // ==========================================
        const mcqData = [
            // Part 1: Modules 1-5
            { section: "Ø§Ù„Ø¬Ø²Ø¡ Ø§Ù„Ø£ÙˆÙ„: Ù…Ø±Ø§Ø¬Ø¹Ø© Ù…Ø§ Ù‚Ø¨Ù„ Ø§Ù„Ù…ÙŠØ¯ (Modules 1-5)", q: "Ø¥Ø°Ø§ ÙƒØ§Ù†Øª Ø§Ù„Ù…Ø¬Ù…ÙˆØ¹Ø© $A = \\{1, 2\\}$ØŒ ÙÙ…Ø§ Ù‡Ùˆ Ø¹Ø¯Ø¯ Ø¹Ù†Ø§ØµØ± Ù…Ø¬Ù…ÙˆØ¹Ø© Ø§Ù„Ù‚ÙˆØ© $P(A)$ØŸ", options: ["2", "3", "4", "8"], a: 2, cheat: "Ø§Ù„Ù‚Ø§Ù†ÙˆÙ† Ù‡Ùˆ $2^n$. Ø¹Ø¯Ø¯ Ø§Ù„Ø¹Ù†Ø§ØµØ± 2ØŒ Ø¥Ø°Ù† $2^2 = 4$." },
            { q: "Ø£ÙŠ Ù‚Ø§Ù†ÙˆÙ† ÙŠÙ…Ø«Ù„Ù‡ Ø§Ù„ØªØ¹Ø¨ÙŠØ± $A \\cup \\emptyset = A$ØŸ", options: ["Commutative", "Identity", "Domination", "Idempotent"], a: 1, cheat: "Ø¯Ù…Ø¬Øª 'Ø´ÙŠØ¡' Ù…Ø¹ 'ÙˆÙ„Ø§ Ø´ÙŠØ¡' ÙˆØ¨Ù‚ÙŠ 'Ø§Ù„Ø´ÙŠØ¡' Ù†ÙØ³Ù‡ = Ù‡ÙˆÙŠØ© (Identity)." },
            { q: "ÙÙŠ Ø§Ù„Ù…Ù†Ø·Ù‚ØŒ Ø§Ù„Ø¹Ø¨Ø§Ø±Ø© Ø§Ù„Ø´Ø±Ø·ÙŠØ© $P \\to Q$ ØªÙƒÙˆÙ† Ø®Ø§Ø·Ø¦Ø© (False) ÙÙŠ Ø­Ø§Ù„Ø© ÙˆØ§Ø­Ø¯Ø© ÙÙ‚Ø· ÙˆÙ‡ÙŠ:", options: ["$P$ ØµØ­ÙŠØ­Ø© Ùˆ $Q$ ØµØ­ÙŠØ­Ø©", "$P$ Ø®Ø§Ø·Ø¦Ø© Ùˆ $Q$ ØµØ­ÙŠØ­Ø©", "$P$ ØµØ­ÙŠØ­Ø© Ùˆ $Q$ Ø®Ø§Ø·Ø¦Ø©", "ÙƒÙ„Ø§Ù‡Ù…Ø§ Ø®Ø§Ø·Ø¦"], a: 2, cheat: "ØªØ°ÙƒØ± 'Ø§Ù„ÙˆØ¹Ø¯ Ø§Ù„ÙƒØ§Ø°Ø¨': ÙˆØ¹Ø¯ØªÙƒ ØªÙ†Ø¬Ø­ ($T$) ÙˆØ±Ø³Ø¨Øª ($F$) -> Ø£Ù†Ø§ ÙƒØ°Ø¨Øª." },
            { q: "Ø¹Ø¯Ø¯ Ø§Ù„Ø­ÙˆØ§Ù (Edges) ÙÙŠ Ø´Ø¬Ø±Ø© ØªØ­ØªÙˆÙŠ Ø¹Ù„Ù‰ $n$ Ù…Ù† Ø§Ù„Ø¹Ù‚Ø¯ ÙŠØ³Ø§ÙˆÙŠ:", options: ["$n$", "$n - 1$", "$2n$", "$n + 1$"], a: 1, cheat: "Ø¯Ø§Ø¦Ù…Ø§Ù‹ Ø§Ù„Ø­ÙˆØ§Ù Ø£Ù‚Ù„ Ù…Ù† Ø§Ù„Ø±Ø¤ÙˆØ³ Ø¨ÙˆØ§Ø­Ø¯ ÙÙŠ Ø§Ù„Ø´Ø¬Ø±Ø©." },
            { q: "Ø§Ù„Ù„ØºØ© $\\{a^n b^n \\mid n \\ge 1\\}$ Ù‡ÙŠ Ù„ØºØ©:", options: ["Regular", "Context-Free", "Finite", "Ù„Ø§ Ø´ÙŠØ¡ Ù…Ù…Ø§ Ø³Ø¨Ù‚"], a: 1, cheat: "Ø£ÙŠ Ù„ØºØ© ÙÙŠÙ‡Ø§ 'Ø¹Ø¯' ÙˆÙ…Ù‚Ø§Ø±Ù†Ø© ($n=n$) ØªØ­ØªØ§Ø¬ Ø°Ø§ÙƒØ±Ø© (Stack)ØŒ Ù„Ø°Ø§ Ù„ÙŠØ³Øª Regular." },
            { q: "Ø§Ù„ØªØ¹Ø¨ÙŠØ± Ø§Ù„Ù†Ù…Ø·ÙŠ Ù„Ù„ØºØ© Ø§Ù„ØªÙŠ ØªØ­ØªÙˆÙŠ Ø¹Ù„Ù‰ Ø§Ù„Ù†Øµ Ø§Ù„ÙØ±Ø¹ÙŠ '01' Ù‡Ùˆ:", options: ["$(0+1)^* 01$", "$01 (0+1)^*$", "$(0+1)^* 01 (0+1)^*$", "$(01)^*$"], a: 2, cheat: "'ØªØ­ØªÙˆÙŠ' ØªØ¹Ù†ÙŠ Ù‚Ø¯ ÙŠØ£ØªÙŠ Ù‚Ø¨Ù„Ù‡Ø§ Ø£ÙŠ Ø´ÙŠØ¡ $(0+1)^*$ ÙˆØ¨Ø¹Ø¯Ù‡Ø§ Ø£ÙŠ Ø´ÙŠØ¡." },
            { q: "Ø§Ù„Ø¹Ù„Ø§Ù‚Ø© Ø¨ÙŠÙ† NFA Ùˆ DFA Ù…Ù† Ø­ÙŠØ« Ø§Ù„Ù‚ÙˆØ© (Power):", options: ["NFA Ø£Ù‚ÙˆÙ‰", "DFA Ø£Ù‚ÙˆÙ‰", "Ù…ØªØ³Ø§ÙˆÙŠØ§Ù†", "Ù„Ø§ ÙŠÙ…ÙƒÙ† Ø§Ù„Ù…Ù‚Ø§Ø±Ù†Ø©"], a: 2, cheat: "ÙÙŠ Ø§Ù„Ø¹Ø§Ù„Ù… Ø§Ù„Ù…Ø­Ø¯ÙˆØ¯ (Finite)ØŒ Ø§Ù„ØªØ®Ù…ÙŠÙ† Ù„Ø§ ÙŠØ¹Ø·ÙŠ Ù‚ÙˆØ© Ø¥Ø¶Ø§ÙÙŠØ©ØŒ ÙÙ‚Ø· ÙŠØ³Ù‡Ù„ Ø§Ù„Ø±Ø³Ù…." },
            { q: "Ù„Ø¥Ø«Ø¨Ø§Øª Ø£Ù† Ù„ØºØ© Ù…Ø¹ÙŠÙ†Ø© 'Ù„ÙŠØ³Øª Regular'ØŒ Ù†Ø³ØªØ®Ø¯Ù…:", options: ["Pumping Lemma", "Chomsky Normal Form", "CYK Algorithm", "Turing Machine"], a: 0, cheat: "ÙƒÙ„Ù…Ø© 'Ù„ÙŠØ³Øª' (Not Regular) Ù…Ø±ØªØ¨Ø·Ø© Ø¯Ø§Ø¦Ù…Ø§Ù‹ Ø¨Ù€ Pumping Lemma." },
            { q: "ÙÙŠ Ø§Ù„Ø±Ø³Ù… Ø§Ù„Ø¨ÙŠØ§Ù†ÙŠØŒ Ø§Ù„Ù…Ø³Ø§Ø± Ø§Ù„Ø°ÙŠ ÙŠØ¨Ø¯Ø£ ÙˆÙŠÙ†ØªÙ‡ÙŠ Ø¨Ù†ÙØ³ Ø§Ù„Ø¹Ù‚Ø¯Ø© ÙŠØ³Ù…Ù‰:", options: ["Path", "Cycle", "Tree", "Edge"], a: 1, cheat: "Ù…Ø«Ù„ Ø§Ù„Ø¯Ø§Ø¦Ø±Ø©ØŒ ØªÙ„Ù ÙˆØªØ±Ø¬Ø¹ Ù„Ù†ÙØ³ Ø§Ù„Ù…ÙƒØ§Ù†." },
            { q: "Ø£ÙŠ Ù…Ù† Ø§Ù„Ø¹Ù…Ù„ÙŠØ§Øª Ø§Ù„ØªØ§Ù„ÙŠØ© 'Ù„ÙŠØ³Øª' Ù…ØºÙ„Ù‚Ø© (Not Closed) Ù„Ù„ØºØ§Øª Ø§Ù„Ù€ RegularØŸ", options: ["Union", "Intersection", "Subset", "Star"], a: 2, cheat: "Ø§Ù„Ù€ Regular Ù‚ÙˆÙŠØ© Ù…Ø¹ ÙƒÙ„ Ø§Ù„Ø¹Ù…Ù„ÙŠØ§Øª Ø§Ù„Ø±ÙŠØ§Ø¶ÙŠØ© Ù…Ø§ Ø¹Ø¯Ø§ Ø£Ø®Ø° 'Ø¬Ø²Ø¡ Ø¹Ø´ÙˆØ§Ø¦ÙŠ' (Subset)." },

            // Part 2: Final Material
            { section: "Ø§Ù„Ø¬Ø²Ø¡ Ø§Ù„Ø«Ø§Ù†ÙŠ: Ù…Ø§Ø¯Ø© Ø§Ù„ÙØ§ÙŠÙ†Ù„ (Modules 6-12)", q: "Ø§Ù„Ù…ÙƒÙˆÙ† Ø§Ù„Ø¥Ø¶Ø§ÙÙŠ Ø§Ù„Ø°ÙŠ ÙŠÙ…ÙŠØ² PDA Ø¹Ù† Finite Automata Ù‡Ùˆ:", options: ["Tape", "Stack", "Two heads", "RAM"], a: 1, cheat: "Ø§Ù„Ù€ PDA ØªØ­ØªØ§Ø¬ Ø°Ø§ÙƒØ±Ø© Ù„ØªØ±ØªÙŠØ¨ Ø§Ù„Ø£Ù‚ÙˆØ§Ø³ØŒ ÙˆÙ‡ÙŠ Ø§Ù„Ù…ÙƒØ¯Ø³ (Stack)." },
            { q: "Ù„ØºØ© Ø§Ù„Ø¨Ø§Ù„ÙŠÙ†Ø¯Ø±ÙˆÙ… $\\{ww^R\\}$ ØªØ¹ØªØ¨Ø±:", options: ["Deterministic CFL", "Non-deterministic CFL", "Regular", "Undecidable"], a: 1, cheat: "Ù„Ø£Ù† Ø§Ù„Ø¢Ù„Ø© ÙŠØ¬Ø¨ Ø£Ù† ØªØ®Ù…Ù† Ù…Ù†ØªØµÙ Ø§Ù„ÙƒÙ„Ù…Ø©. Ø§Ù„ØªØ®Ù…ÙŠÙ† = Non-deterministic." },
            { q: "Ø£ÙŠ Ø§Ù„Ù‚ÙˆØ§Ø¹Ø¯ Ø§Ù„ØªØ§Ù„ÙŠØ© Ù…ÙƒØªÙˆØ¨Ø© Ø¨ØµÙŠØºØ© Chomsky Normal Form (CNF)ØŸ", options: ["$A \\to BC$", "$A \\to B$", "$A \\to aB$", "$A \\to \\epsilon$"], a: 0, cheat: "Ù‚Ø§Ù†ÙˆÙ† CNF: ÙŠØ§ 'ÙƒØ¨ÙŠØ±ÙŠÙ†' ($BC$) ÙŠØ§ 'ØµØºÙŠØ± Ù„ÙˆØ­Ø¯Ù‡' ($a$)." },
            { q: "Ø®ÙˆØ§Ø±Ø²Ù…ÙŠØ© CYK ØªØ³ØªØ®Ø¯Ù… Ù„Ù„ØªØ­Ù‚Ù‚ Ù…Ù†:", options: ["Ù‡Ù„ Ø§Ù„Ù„ØºØ© RegularØŸ", "Membership (Ø§Ù„Ø§Ù†ØªÙ…Ø§Ø¡)", "Ù‡Ù„ Ø§Ù„Ù„ØºØ© ÙØ§Ø±ØºØ©ØŸ", "Ø§Ù„ØªÙˆÙ‚Ù"], a: 1, cheat: "CYK ÙˆØ¸ÙŠÙØªÙ‡ ÙŠÙ‚ÙˆÙ„ Ù„Ùƒ: 'Ù†Ø¹Ù… Ø§Ù„ÙƒÙ„Ù…Ø© Ù…Ù‚Ø¨ÙˆÙ„Ø© ÙÙŠ Ø§Ù„Ù„ØºØ©' Ø£Ùˆ 'Ù„Ø§'." },
            { q: "Ø§Ù„Ù„ØºØ§Øª Ø­Ø±Ø© Ø§Ù„Ø³ÙŠØ§Ù‚ (CFL) 'ØºÙŠØ± Ù…ØºÙ„Ù‚Ø©' ØªØ­Øª Ø¹Ù…Ù„ÙŠØ©:", options: ["Union", "Intersection", "Concatenation", "Star"], a: 1, cheat: "Ø§Ù„Ù€ CFL ØªÙƒØ±Ù‡ Ø§Ù„ØªÙ‚Ø§Ø·Ø¹ ÙˆØ§Ù„Ù…ØªÙ…Ù…Ø©." },
            { q: "Ø§Ù„Ù‡Ø¯Ù Ø§Ù„Ø£Ø³Ø§Ø³ÙŠ Ù…Ù† Pumping Lemma Ù„Ù„Ù€ CFL Ù‡Ùˆ:", options: ["Ø¥Ø«Ø¨Ø§Øª Ø£Ù†Ù‡Ø§ CFL", "Ø¥Ø«Ø¨Ø§Øª Ø£Ù†Ù‡Ø§ Ù„ÙŠØ³Øª CFL", "ØªØ­ÙˆÙŠÙ„ PDA", "ØªØ¨Ø³ÙŠØ· Ø§Ù„Ù‚ÙˆØ§Ø¹Ø¯"], a: 1, cheat: "Ù‡ÙŠ Ø£Ø¯Ø§Ø© Ø§Ù„Ù†ÙÙŠ Ø¯Ø§Ø¦Ù…Ø§Ù‹." },
            { q: "ÙÙŠ ØªØ­ÙˆÙŠÙ„ Ø§Ù„Ù‚ÙˆØ§Ø¹Ø¯ (Simplification)ØŒ Ù…Ø§ Ù‡Ùˆ Ø§Ù„ØªØ±ØªÙŠØ¨ Ø§Ù„ØµØ­ÙŠØ­ Ù„Ù„Ø­Ø°ÙØŸ", options: ["Unit $\\to$ Null $\\to$ Useless", "Useless $\\to$ Unit", "$\\epsilon \\to$ Unit $\\to$ Useless", "Ø§Ù„ØªØ±ØªÙŠØ¨ Ù„Ø§ ÙŠÙ‡Ù…"], a: 2, cheat: "ØªØ°ÙƒØ± EUU: Ø¥Ø¨Ø³ÙŠÙ„ÙˆÙ†ØŒ Ø«Ù… UnitØŒ Ø«Ù… Useless." },
            { q: "Ø§Ù„ÙØ±Ù‚ Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ Ø¨ÙŠÙ† TM Ùˆ PDA Ù‡Ùˆ:", options: ["TM Ù„Ø¯ÙŠÙ‡Ø§ Ù…ÙƒØ¯Ø³", "TM ØªØªØ­Ø±Ùƒ ÙŠÙ…ÙŠÙ†Ø§Ù‹ ÙˆÙŠØ³Ø§Ø±Ø§Ù‹ ÙˆØªÙƒØªØ¨", "TM Ø£Ø¶Ø¹Ù", "TM Ù„Ø§ ØªØªÙˆÙ‚Ù"], a: 1, cheat: "Ø§Ù„Ù€ TM Ù„Ø¯ÙŠÙ‡Ø§ Ø­Ø±ÙŠØ© Ù…Ø·Ù„Ù‚Ø© ÙÙŠ Ø§Ù„Ø­Ø±ÙƒØ© ÙˆØ§Ù„ÙƒØªØ§Ø¨Ø©." },
            { q: "Ø§Ù„Ù…Ø´ÙƒÙ„Ø© Ø§Ù„ØªÙŠ 'Ù„Ø§ ØªÙˆØ¬Ø¯ Ø®ÙˆØ§Ø±Ø²Ù…ÙŠØ© Ù„Ø­Ù„Ù‡Ø§' ØªØ³Ù…Ù‰:", options: ["Intractable", "Undecidable", "NP-Complete", "Decidable"], a: 1, cheat: "Ù„Ø§ Ø®ÙˆØ§Ø±Ø²Ù…ÙŠØ© = Ù„Ø§ Ù‚Ø±Ø§Ø± (Undecidable)." },
            { q: "Ù…Ø´ÙƒÙ„Ø© Ø§Ù„ØªÙˆÙ‚Ù (Halting Problem) Ù‡ÙŠ Ù…Ø«Ø§Ù„ Ø¹Ù„Ù‰:", options: ["Decidable", "RE but not Recursive", "Regular", "CFL"], a: 1, cheat: "ÙŠÙ…ÙƒÙ†Ù†Ø§ Ù…Ø¹Ø±ÙØ© Ø§Ù„ØªÙˆÙ‚ÙØŒ Ù„ÙƒÙ† Ù„Ø§ ÙŠÙ…ÙƒÙ†Ù†Ø§ Ù…Ø¹Ø±ÙØ© Ø§Ù„ØªØ¹Ù„ÙŠÙ‚ (Loop)." },
            { q: "Ø§Ù„Ù„ØºØ© Ø§Ù„Ù‚Ø·Ø±ÙŠØ© ($L_d$) ØªØ¹ØªØ¨Ø±:", options: ["Recursive", "RE", "Not RE", "Finite"], a: 2, cheat: "Ù‡ÙŠ Ø§Ù„Ù„ØºØ© Ø§Ù„ÙˆØ­ÙŠØ¯Ø© 'Ø®Ø§Ø±Ø¬ Ø§Ù„ØµÙ†Ø¯ÙˆÙ‚'. Ù„Ø§ ÙŠÙˆØ¬Ø¯ Ø¢Ù„Ø© ØªÙ‚Ø¨Ù„Ù‡Ø§." },
            { q: "ÙƒÙ„ Ù„ØºØ© Recursive Ù‡ÙŠ Ø¨Ø§Ù„Ø¶Ø±ÙˆØ±Ø© Recursively Enumerable. Ù‡Ø°Ù‡ Ø§Ù„Ø¹Ø¨Ø§Ø±Ø©:", options: ["ØµØ­ÙŠØ­Ø© Ø¯Ø§Ø¦Ù…Ø§Ù‹", "Ø®Ø§Ø·Ø¦Ø© Ø¯Ø§Ø¦Ù…Ø§Ù‹", "ØªØ¹ØªÙ…Ø¯ Ø¹Ù„Ù‰ Ø§Ù„Ù„ØºØ©", "Ù„Ù„ØºØ§Øª Ø§Ù„Ù…Ù†ØªÙ‡ÙŠØ© ÙÙ‚Ø·"], a: 0, cheat: "Ø§Ù„Ù€ Recursive (Ø§Ù„Ø§Ø¨Ù† Ø§Ù„Ø¨Ø§Ø±) Ø¬Ø²Ø¡ Ù…Ù† Ø¹Ø§Ø¦Ù„Ø© RE Ø§Ù„ÙƒØ¨ÙŠØ±Ø©." },
            { q: "Ø¢Ù„Ø© ØªÙˆØ±Ù†Øº Ù…ØªØ¹Ø¯Ø¯Ø© Ø§Ù„Ø£Ø´Ø±Ø·Ø© Ù…Ù‚Ø§Ø±Ù†Ø© Ø¨Ø¢Ù„Ø© Ø§Ù„Ø´Ø±ÙŠØ· Ø§Ù„ÙˆØ§Ø­Ø¯:", options: ["Ø£Ù‚ÙˆÙ‰", "Equivalent Power (Ù…ØªÙƒØ§ÙØ¦Ø©)", "Ø£Ø¶Ø¹Ù", "Ù„Ø§ Ø¹Ù„Ø§Ù‚Ø©"], a: 1, cheat: "ÙÙŠ Ø¹Ø§Ù„Ù… Ø§Ù„Ø­Ù„ÙˆÙ„ (Decidability)ØŒ ÙƒÙ„ Ø£Ù†ÙˆØ§Ø¹ Ø§Ù„ØªÙˆØ±Ù†Øº Ù…ØªØ³Ø§ÙˆÙŠØ©." },
            { q: "Ø§Ù„ÙØ¦Ø© P ØªØ­ØªÙˆÙŠ Ø¹Ù„Ù‰ Ø§Ù„Ù…Ø´Ø§ÙƒÙ„ Ø§Ù„ØªÙŠ:", options: ["Ù„Ø§ ØªØ­Ù„", "ØªØ­Ù„ ÙÙŠ ÙˆÙ‚Øª Polynomial Ø¨Ø¢Ù„Ø© Deterministic", "ØªØ­Ù„ Ø¨Ø¢Ù„Ø© Non-deterministic", "ÙˆÙ‚Øª Exponential"], a: 1, cheat: "$P$ = Polynomial (Ø³Ù‡Ù„Ø© Ø§Ù„Ø­Ù„)." },
            { q: "Ø§Ù„ÙØ¦Ø© NP ØªØ¹Ù†ÙŠ:", options: ["Not Polynomial", "Non-deterministic Polynomial", "New Problem", "No Problem"], a: 1, cheat: "Ø§Ù„Ù€ N ØªØ¹Ù†ÙŠ Non-deterministic (Ø³Ù‡Ù„Ø© Ø§Ù„ØªØ­Ù‚Ù‚)." },
            { q: "Ø¥Ø°Ø§ ÙƒØ§Ù†Øª Ø§Ù„Ù…Ø´ÙƒÙ„Ø© $X$ Ù‡ÙŠ NP-CompleteØŒ ÙˆØªÙ… Ø­Ù„Ù‡Ø§ Ø¨Ù€ Polynomial timeØŒ ÙÙ‡Ø°Ø§ ÙŠØ¹Ù†ÙŠ:", options: ["$P = NP$", "$P \\neq NP$", "$NP = PSPACE$", "Ù„Ø§ Ø´ÙŠØ¡"], a: 0, cheat: "Ø¥Ø°Ø§ Ø³Ù‚Ø· Ø§Ù„Ø²Ø¹ÙŠÙ… (NPC)ØŒ ØªØ³Ù‚Ø· ÙƒÙ„ Ø§Ù„Ù…Ø´Ø§ÙƒÙ„ ÙˆØªØµØ¨Ø­ Ø³Ù‡Ù„Ø©." },
            { q: "Ù…Ø´ÙƒÙ„Ø© SAT Ù‡ÙŠ Ø£ÙˆÙ„ Ù…Ø´ÙƒÙ„Ø© Ø£Ø«Ø¨Øª Ø£Ù†Ù‡Ø§:", options: ["Undecidable", "NP-Complete", "P", "CFL"], a: 1, cheat: "Ù†Ø¸Ø±ÙŠØ© ÙƒÙˆÙƒ (Cook's Theorem) = SAT is NPC." },
            { q: "Ù…Ø´ÙƒÙ„Ø© 2-SAT ØªÙ†ØªÙ…ÙŠ Ù„ÙØ¦Ø©:", options: ["P", "NP-Complete", "Undecidable", "NP-Hard"], a: 0, cheat: "Ø±Ù‚Ù… 2 Ø³Ù‡Ù„ (P)ØŒ Ø±Ù‚Ù… 3 ØµØ¹Ø¨ (NPC)." },
            { q: "Ù…Ø´ÙƒÙ„Ø© Ø§Ù„Ø¨Ø§Ø¦Ø¹ Ø§Ù„Ù…ØªØ¬ÙˆÙ„ (TSP) ØªÙ†ØªÙ…ÙŠ Ù„ÙØ¦Ø©:", options: ["P", "NP-Complete", "Regular", "Linear"], a: 1, cheat: "Ø£ÙŠ Ù…Ø´ÙƒÙ„Ø© 'Ø£ÙØ¶Ù„ Ø·Ø±ÙŠÙ‚ ÙŠÙ…Ø± Ø¨Ø§Ù„ÙƒÙ„' Ù‡ÙŠ Ù…Ø¹Ù‚Ø¯Ø© (NPC)." },
            { q: "Ø§Ù„Ø¹Ù„Ø§Ù‚Ø© Ø§Ù„ØµØ­ÙŠØ­Ø© Ø¨ÙŠÙ† ÙØ¦Ø§Øª Ø§Ù„ØªØ¹Ù‚ÙŠØ¯ Ù‡ÙŠ:", options: ["$P \\subseteq NP \\subseteq PSPACE$", "$NP \\subseteq P$", "$PSPACE \\subseteq P$", "$P=NP=PSPACE$"], a: 0, cheat: "Ø¯Ø§Ø¦Ø±Ø© $P$ ØµØºÙŠØ±Ø©ØŒ Ø¯Ø§Ø®Ù„ $NP$ØŒ Ø¯Ø§Ø®Ù„ Ø§Ù„ÙˆØ­Ø´ $PSPACE$." },
            { q: "Ù†Ø¸Ø±ÙŠØ© Ø³Ø§ÙÙŠØªØ´ (Savitch) ØªÙ†Øµ Ø¹Ù„Ù‰ Ø£Ù†:", options: ["$P=NP$", "$PS = NPS$", "$P=PSPACE$", "$NP=NPS$"], a: 1, cheat: "ÙÙŠ Ø¹Ø§Ù„Ù… Ø§Ù„Ù…Ø³Ø§Ø­Ø© (Space)ØŒ Ø§Ù„Ù…Ø­Ø¯Ø¯ ÙˆØºÙŠØ± Ø§Ù„Ù…Ø­Ø¯Ø¯ Ù…ØªØ³Ø§ÙˆÙŠØ§Ù†." },
            { q: "Ù…Ø´ÙƒÙ„Ø© QBF (Quantified Boolean Formula) Ù‡ÙŠ:", options: ["NP-Complete", "PSPACE-Complete", "P", "Undecidable"], a: 1, cheat: "Ø§Ù„Ù€ SAT Ù…Ù„ÙƒØ© NPØŒ ÙˆØ§Ù„Ù€ QBF Ù…Ù„ÙƒØ© PSPACE." },
            { q: "Ø§Ù„Ù…Ø´ÙƒÙ„Ø© Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…Ø© Ù„Ø¥Ø«Ø¨Ø§Øª Undecidability Ù„Ù…Ø´Ø§ÙƒÙ„ Ø£Ø®Ø±Ù‰ Ø¹Ø¨Ø± Ø§Ù„ØªØ­ÙˆÙŠÙ„ Ù‡ÙŠ:", options: ["3-SAT", "PCP", "TSP", "Sorting"], a: 1, cheat: "PCP Ù‡ÙŠ Ø§Ù„Ø¬ÙˆÙƒØ±ØŒ ØªØ±Ø¨Ø· Ø§Ù„ØªÙˆØ±Ù†Øº Ø¨Ø§Ù„Ù‚ÙˆØ§Ø¹Ø¯." },
            { q: "Ø§Ù„ØªØ±ØªÙŠØ¨ Ø§Ù„ØµØ­ÙŠØ­ Ù„Ø¥Ø«Ø¨Ø§Øª Ø£Ù† 3-SAT Ù‡ÙŠ NP-Complete:", options: ["$3-SAT \\to SAT$", "$SAT \\to 3-SAT$", "$3-SAT \\to P$", "$TSP \\to 3-SAT$"], a: 1, cheat: "Ù†Ù†Ù‚Ù„ Ø§Ù„Ø¹Ø¯ÙˆÙ‰ Ù…Ù† Ø§Ù„Ù‚Ø¯ÙŠÙ… (Ø§Ù„Ø£ØµÙ„ SAT) Ø¥Ù„Ù‰ Ø§Ù„Ø¬Ø¯ÙŠØ¯ (3-SAT)." },
            { q: "Ø£ÙŠ Ù…Ù† Ø§Ù„ØªØ§Ù„ÙŠ ÙŠØ¹ØªØ¨Ø± Ø¢Ù„Ø© 'ØºÙŠØ± Ø¹Ù…Ù„ÙŠØ©' (Intractable)ØŸ", options: ["$O(n^2)$", "$O(n \\log n)$", "$O(2^n)$", "$O(n^{100})$"], a: 2, cheat: "Ø£ÙŠ Ø´ÙŠØ¡ ÙÙŠÙ‡ Ø£ÙØ³ (Exponential) ÙŠØ¹ØªØ¨Ø± ÙƒØ§Ø±Ø«Ø©." },
            { q: "Ø§Ù„Ù€ Universal Turing Machine ØªØ³ØªØ·ÙŠØ¹:", options: ["Ø­Ù„ Ø§Ù„ØªÙˆÙ‚Ù", "Ù…Ø­Ø§ÙƒØ§Ø© Ø£ÙŠ Ø¢Ù„Ø© Ø£Ø®Ø±Ù‰", "Ø§Ù„Ø¹Ù…Ù„ Ø¨Ø³Ø±Ø¹Ø© Ø§Ù„Ø¶ÙˆØ¡", "Ø­Ù„ Undecidable"], a: 1, cheat: "Ù‡ÙŠ Ø§Ù„Ù…Ø­Ø§ÙƒÙŠ (Simulator)." },
            { q: "Ø§Ù„Ø´Ø±Ø· Ù„ÙƒÙŠ ØªÙƒÙˆÙ† Ø§Ù„Ù…Ø´ÙƒÙ„Ø© NP-Complete:", options: ["ÙÙŠ NP ÙÙ‚Ø·", "ÙÙŠ P", "ÙÙŠ NP ÙˆØªØªØ­ÙˆÙ„ Ø¥Ù„ÙŠÙ‡Ø§ ÙƒÙ„ Ù…Ø´Ø§ÙƒÙ„ NP", "Undecidable"], a: 2, cheat: "Ù„Ø§Ø²Ù… ØªÙƒÙˆÙ† 'Ù…Ù† Ø§Ù„Ø´Ù„Ø©' Ùˆ 'Ø²Ø¹ÙŠÙ…Ø©'." },
            { q: "Ø§Ù„Ø¹Ù„Ø§Ù‚Ø© Ø¨ÙŠÙ† $L$ ÙˆÙ…ØªÙ…Ù…ØªÙ‡Ø§ ÙÙŠ ÙØ¦Ø© Recursive:", options: ["Ø§Ù„Ù…ØªÙ…Ù…Ø© Ø£ÙŠØ¶Ø§Ù‹ Recursive", "Ø§Ù„Ù…ØªÙ…Ù…Ø© RE", "Ù„Ø§ Ø¹Ù„Ø§Ù‚Ø©", "Undecidable"], a: 0, cheat: "Ø§Ù„Ù€ Recursive Ù†Ø¸ÙŠÙØ©Ø› ØªÙ‚Ù„Ø¨ Ø§Ù„Ø¬ÙˆØ§Ø¨ ÙˆØªØ¸Ù„ Ù†Ø¸ÙŠÙØ©." },
            { q: "ÙÙŠ Ø¥Ø«Ø¨Ø§Øª DiagonalizationØŒ Ù†Ø³ØªÙ†ØªØ¬ Ø£Ù†:", options: ["Ø§Ù„Ù„ØºØ§Øª = Ø§Ù„Ø¢Ù„Ø§Øª", "Ø§Ù„Ù„ØºØ§Øª > Ø§Ù„Ø¢Ù„Ø§Øª Ø¨ÙƒØ«ÙŠØ±", "ÙƒÙ„ Ù„ØºØ© Ù„Ù‡Ø§ Ø¢Ù„Ø©", "Ø§Ù„Ø¢Ù„Ø§Øª Ù„Ø§ Ù†Ù‡Ø§Ø¦ÙŠØ©"], a: 1, cheat: "Ø§Ù„Ù…Ø´Ø§ÙƒÙ„ (Ø§Ù„Ù„ØºØ§Øª) Ø£ÙƒØ«Ø± Ù…Ù† Ø§Ù„Ø­Ù„ÙˆÙ„ (Ø§Ù„Ø¨Ø±Ø§Ù…Ø¬)." },
            { q: "Ø§Ù„Ø±Ù…Ø² $\\vdash$ ÙÙŠ Ø³ÙŠØ§Ù‚ Ø¢Ù„Ø© ØªÙˆØ±Ù†Øº ÙŠØ¹Ù†ÙŠ:", options: ["Ø§Ù„Ù†Ù‡Ø§ÙŠØ©", "Ø®Ø·ÙˆØ© Ø§Ù†ØªÙ‚Ø§Ù„ (Move)", "Ø§Ù„Ù‚Ø¨ÙˆÙ„", "Ø§Ù„Ù…Ø¤Ø´Ø±"], a: 1, cheat: "ÙŠØ´Ø¨Ù‡ Ø§Ù„Ø²Ù†Ø§Ø¯ØŒ ÙŠØ¹Ù†ÙŠ Ø­Ø±ÙƒØ© ÙˆØ§Ø­Ø¯Ø©." }
        ];

        const essayData = [
            { q: "Ø³1: Ø§Ø´Ø±Ø­ Ø§Ù„ÙØ±Ù‚ Ø¨ÙŠÙ† Decidable Ùˆ Undecidable problemsØŸ", a: "<strong>Decidable (Recursive):</strong> ØªÙˆØ¬Ø¯ Ø®ÙˆØ§Ø±Ø²Ù…ÙŠØ© ØªØ¶Ù…Ù† Ø§Ù„ØªÙˆÙ‚Ù ÙˆØªØ¹Ø·ÙŠ Ø¥Ø¬Ø§Ø¨Ø© (Ù†Ø¹Ù…/Ù„Ø§) Ù„ÙƒÙ„ Ø§Ù„Ù…Ø¯Ø®Ù„Ø§Øª.<br><strong>Undecidable:</strong> Ù„Ø§ ØªÙˆØ¬Ø¯ Ø®ÙˆØ§Ø±Ø²Ù…ÙŠØ© ØªØ¶Ù…Ù† Ø§Ù„Ø­Ù„ Ù„ÙƒÙ„ Ø§Ù„Ù…Ø¯Ø®Ù„Ø§Øª (Ù‚Ø¯ ØªØ¯Ø®Ù„ ÙÙŠ Loop Ù„Ø§ Ù†Ù‡Ø§Ø¦ÙŠØ©)." },
            { q: "Ø³2: Ø¹Ø±Ù P Ùˆ NP Ùˆ NP-Complete ÙˆØ§Ø°ÙƒØ± Ø§Ù„Ø¹Ù„Ø§Ù‚Ø© Ø¨ÙŠÙ†Ù‡Ù…ØŸ", a: "<strong>P:</strong> ØªØ­Ù„ ÙÙŠ ÙˆÙ‚Øª Ø­Ø¯ÙˆØ¯ÙŠ Ø¨Ø¢Ù„Ø© Deterministic.<br><strong>NP:</strong> ØªØ­Ù„ ÙÙŠ ÙˆÙ‚Øª Ø­Ø¯ÙˆØ¯ÙŠ Ø¨Ø¢Ù„Ø© Non-deterministic (Ø³Ù‡Ù„Ø© Ø§Ù„ØªØ­Ù‚Ù‚).<br><strong>NP-Complete:</strong> Ø£ØµØ¹Ø¨ Ù…Ø´Ø§ÙƒÙ„ NPØŒ Ø¥Ø°Ø§ Ø­ÙÙ„Øª ÙˆØ§Ø­Ø¯Ø© Ù…Ù†Ù‡Ø§ Ø¨Ù€ PØŒ Ø­ÙÙ„Øª ÙƒÙ„Ù‡Ø§.<br>Ø§Ù„Ø¹Ù„Ø§Ù‚Ø©: $P \\subseteq NP$." },
            { q: "Ø³3: Ø­ÙˆÙ„ Ø§Ù„Ù‚ÙˆØ§Ø¹Ø¯ $S \\to aSb \\mid ab$ Ø¥Ù„Ù‰ CNFØŸ", a: "1. Ù…ØªØºÙŠØ±Ø§Øª Ù„Ù„Ø±Ù…ÙˆØ²: $X_a \\to a, X_b \\to b$.<br>2. Ø§Ù„Ù‚Ø§Ø¹Ø¯Ø©: $S \\to X_a S X_b \\mid X_a X_b$.<br>3. ÙƒØ³Ø± Ø§Ù„Ø«Ù„Ø§Ø«ÙŠ: $S \\to X_a Y, Y \\to S X_b$.<br><strong>Ø§Ù„Ù†Ø§ØªØ¬:</strong> $S \\to X_a Y \\mid X_a X_b$, $Y \\to S X_b$, $X_a \\to a, X_b \\to b$." },
            { q: "Ø³4: Ù…Ø§ Ù‡ÙŠ ÙÙƒØ±Ø© Pumping Lemma for CFLØŸ", a: "ØªÙ†Øµ Ø¹Ù„Ù‰ Ø£Ù†Ù‡ Ù„Ø£ÙŠ ÙƒÙ„Ù…Ø© Ø·ÙˆÙŠÙ„Ø© $z$ ÙÙŠ Ø§Ù„Ù„ØºØ©ØŒ ÙŠÙ…ÙƒÙ† ØªÙ‚Ø³ÙŠÙ…Ù‡Ø§ Ù„Ù€ 5 Ø£Ø¬Ø²Ø§Ø¡ $z=uvwxy$ØŒ Ø¨Ø­ÙŠØ« ÙŠÙ…ÙƒÙ† ØªÙƒØ±Ø§Ø± $v$ Ùˆ $x$ Ù…Ø¹Ø§Ù‹ ($uv^iwx^iy$) ÙˆØªØ¨Ù‚Ù‰ Ø§Ù„ÙƒÙ„Ù…Ø© ÙÙŠ Ø§Ù„Ù„ØºØ©. ØªØ³ØªØ®Ø¯Ù… Ù„Ø¥Ø«Ø¨Ø§Øª Ø£Ù† Ù„ØºØ© Ù…Ø§ Ù„ÙŠØ³Øª CFL." },
            { q: "Ø³5: Ù„Ù…Ø§Ø°Ø§ Ù†Ø¹ØªØ¨Ø± Ù…Ø´ÙƒÙ„Ø© SAT Ù…Ù‡Ù…Ø© Ø¬Ø¯Ø§Ù‹ØŸ", a: "Ù„Ø£Ù†Ù‡Ø§ Ø£ÙˆÙ„ Ù…Ø´ÙƒÙ„Ø© Ø£Ø«Ø¨ØªØª Ø£Ù†Ù‡Ø§ <strong>NP-Complete</strong> (Cook's Theorem). ÙˆÙ‡ÙŠ Ø§Ù„Ø£Ø³Ø§Ø³ Ø§Ù„Ø°ÙŠ ØªØ³ØªØ®Ø¯Ù…Ù‡ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù…Ø´Ø§ÙƒÙ„ Ø§Ù„Ø£Ø®Ø±Ù‰ Ù„Ø¥Ø«Ø¨Ø§Øª ØµØ¹ÙˆØ¨ØªÙ‡Ø§ Ø¹Ù† Ø·Ø±ÙŠÙ‚ Ø§Ù„ØªØ­ÙˆÙŠÙ„ (Reduction) Ù…Ù†Ù‡Ø§." }
        ];

        // ==========================================
        // 2. ENGINE (No Changes Needed)
        // ==========================================
        let timeLeft = localStorage.getItem('theory_exam_time') ? parseInt(localStorage.getItem('theory_exam_time')) : 90 * 60;
        let timerInterval;

        function initExam() {
            const container = document.getElementById('quiz-container');
            
            // Add Section Headers & Questions
            mcqData.forEach((item, index) => {
                if(item.section) {
                    const secHeader = document.createElement('h2');
                    secHeader.className = "text-xl font-bold text-purple-800 mt-8 mb-4 border-b-2 border-purple-200 pb-2";
                    secHeader.innerText = item.section;
                    container.appendChild(secHeader);
                }

                const card = document.createElement('div');
                card.className = 'question-card';
                card.id = `q-${index}`;
                
                let opts = '';
                item.options.forEach((opt, i) => {
                    opts += `<button class="option-btn" onclick="check(${index}, ${i})">${opt}</button>`;
                });

                card.innerHTML = `
                    <h3 class="font-bold text-lg mb-4 text-purple-900">Ø³${index+1}: ${item.q}</h3>
                    <div class="space-y-2">${opts}</div>
                    <div class="cheat-box" id="cheat-${index}">
                        <strong>ğŸ’¡ ØªÙ„Ù…ÙŠØ­:</strong> ${item.cheat}
                    </div>
                `;
                container.appendChild(card);
            });

            // Essay Section
            const essayHeader = document.createElement('h2');
            essayHeader.className = "text-2xl font-black text-purple-800 mt-12 mb-6 border-b-4 border-purple-200 pb-2";
            essayHeader.innerText = "Ø§Ù„Ø£Ø³Ø¦Ù„Ø© Ø§Ù„Ù…Ù‚Ø§Ù„ÙŠØ© (Essay Questions)";
            container.appendChild(essayHeader);

            essayData.forEach((item, index) => {
                const card = document.createElement('div');
                card.className = 'question-card border-l-4 border-l-purple-500';
                card.innerHTML = `
                    <h3 class="font-bold text-lg mb-4 text-purple-900">${item.q}</h3>
                    <textarea class="w-full p-3 border rounded-lg mb-4 font-sans" rows="3" placeholder="Ø§ÙƒØªØ¨ Ø¥Ø¬Ø§Ø¨ØªÙƒ Ù‡Ù†Ø§ Ù„Ù„ØªØ¯Ø±ÙŠØ¨..."></textarea>
                    <button onclick="toggleEssay(${index})" class="text-sm bg-purple-100 text-purple-700 px-3 py-1 rounded hover:bg-purple-200 font-bold transition">Ø¹Ø±Ø¶ Ø§Ù„Ø¥Ø¬Ø§Ø¨Ø© Ø§Ù„Ù†Ù…ÙˆØ°Ø¬ÙŠØ©</button>
                    <div class="essay-answer" id="essay-${index}">${item.a}</div>
                `;
                container.appendChild(card);
            });

            startTimer();
            restoreProgress();
            if(window.MathJax) window.MathJax.typesetPromise();
        }

        function check(qIdx, optIdx) {
            const card = document.getElementById(`q-${qIdx}`);
            const btns = card.querySelectorAll('.option-btn');
            const correctIdx = mcqData[qIdx].a;

            btns.forEach(b => b.classList.add('disabled'));

            if (optIdx === correctIdx) {
                btns[optIdx].classList.add('correct');
                card.classList.add('correct-card');
            } else {
                btns[optIdx].classList.add('wrong');
                btns[correctIdx].classList.add('correct');
                card.classList.add('wrong-card');
            }

            document.getElementById(`cheat-${qIdx}`).style.display = 'block';
            saveProgress(qIdx, optIdx);
        }

        function toggleEssay(idx) {
            const el = document.getElementById(`essay-${idx}`);
            el.style.display = el.style.display === 'block' ? 'none' : 'block';
            if(window.MathJax) window.MathJax.typesetPromise();
        }

        function revealAll() {
            if(!confirm("Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ØŸ Ø³ÙŠØªÙ… Ø­Ù„ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø£Ø³Ø¦Ù„Ø©.")) return;
            mcqData.forEach((item, i) => {
                check(i, item.a);
            });
            essayData.forEach((item, i) => {
                document.getElementById(`essay-${i}`).style.display = 'block';
            });
        }

        function startTimer() {
            const el = document.getElementById('timer');
            timerInterval = setInterval(() => {
                if (timeLeft <= 0) {
                    clearInterval(timerInterval);
                    el.innerText = "Ø§Ù†ØªÙ‡Ù‰ Ø§Ù„ÙˆÙ‚Øª!";
                    return;
                }
                timeLeft--;
                localStorage.setItem('theory_exam_time', timeLeft);
                const m = Math.floor(timeLeft / 60);
                const s = timeLeft % 60;
                el.innerText = `${m}:${s < 10 ? '0'+s : s}`;
            }, 1000);
        }

        function resetExam() {
            if(confirm("Ø¥Ø¹Ø§Ø¯Ø© Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø± Ø³ØªØ­Ø°Ù ÙƒÙ„ Ø¥Ø¬Ø§Ø¨Ø§ØªÙƒ. Ù…ÙˆØ§ÙÙ‚ØŸ")) {
                localStorage.removeItem('theory_exam_progress');
                localStorage.removeItem('theory_exam_time');
                location.reload();
            }
        }

        function saveProgress(q, a) {
            let p = JSON.parse(localStorage.getItem('theory_exam_progress') || '{}');
            p[q] = a;
            localStorage.setItem('theory_exam_progress', JSON.stringify(p));
        }

        function restoreProgress() {
            let p = JSON.parse(localStorage.getItem('theory_exam_progress') || '{}');
            for (let q in p) {
                check(parseInt(q), p[q]);
            }
        }

        document.addEventListener('DOMContentLoaded', initExam);
    </script>
</body>
</html>